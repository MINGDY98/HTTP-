# 5장 웹서버

- 여러 종류의 소프트웨어 및 하드웨어 웹 서버에 대해 조사
- HTTP 통신을 진단하는 간단한 웹서버 코드로 작성
- 어떻게 웹 서버가 HTTP 트랜잭션을 처리하는지 설명

### 웹 서버란?
웹 서버 소프트웨어와 웹페이지 제공에 특화된 장비(컴퓨터)모두 가리킴
모두 리소스에 대한 HTTP 요청을 받아 콘텐츠를 클라이언트에게 돌려주는 특징 존재
- HTTP 프로토콜 구현
- 웹 리소스 관리
- 웹 서버 관리 기능 제공
- TCP 커넥션 관리에 대한 책임을 운영체제와 나눠가짐

#### 웹서버의 여러 형태
- 다목적 소프트웨어 웹 서버
: 많은 웹서버 프로그램 중 몇몇개가 주로 사용됨(마이크로소프트 웹서버, 아파치 웹 서버, nginx 웹서버) 
- 전자기기안에 컴퓨터 칩으로 웹서버가 내장된 형태
: 일반 소비자용 ex 프린터나 가전제품

### 웹 서버 동작

type-o-serve 예시

특정 포트인 8080포트로 로 수신하는 type-oserve 진단 서버 시작
브라우저에 이 웹서버로 접근가능해짐 http://www.joes-hardware.com:8080/foo/bar/blah.txt에 접근
type-o-serve 프로그램은 브라우저로부터 HTTP 요청 메시지받고, HTTP응답 메시지를 브라우저에게 돌려줌

1. 커넥션을 맺는다. - 원하는 클라이언트의 접속을 받아들인다. (특정 포트를 통해)
2. HTTP 요청 메시지를 네트워크로부터 읽어 들인다.
3. 요청 메시지를 해석하고 행동을 취한다. (요청을 처리한다.)
4. 메세지에서 지정된 리소스에 접근한다.
5. 응답을 만든다.
6. 응답을 보낸다.
7. 트랜잭션을 로그로 남긴다.

##### 1단계 클라이언트 커넥션 수락

1.클라이언트가 서버에 대한 지속적 커넥션을 갖고 있지 않다면, 새롭게 연결해야한다.
클라이언트가 웹서버에 TCP 커넥션을 요청하면 웹 서버는 그 커넥션을 맺고 TCP 커넥션에서 IP주소를 추출해 어떤 클라이언트인지 확인한다.
이때 웹 서버는 원치않은 컨넥션일경우 닫을 수 있다.
```
대부분 웹서버는 reverse DNS로 클라이언트의 IP주소를 클라이언트의 호스트명으로 변환하도록 설정되어있다.
호스트명을 구체적인 접근 제어와 로깅을 위해 사용할 수 있는데, hostname lookup은 꽤 많은 시간이 걸려 웹 트랜잭션이 느려질 수 있어 특정 콘텐츠에 대해서만 켜둔다.
ex) 아파치는 HTML, CGI 리소스만을 위해 호스트명 분석을 켬

또 몇몇 웹서버는 IETF ident 프로토콜 지원. ident 프로토콜은 서버에게 어떤 사용자 이름이 HTTP 커넥션을 초기화했는지 찾아낼 수있게 해줌
-> 이 정보는 웹서버 로깅에 유요해 널리쓰이는 Common log format의 두번째 필드는 각 HTTP 요청의 ident 사용자 이름을 담음
-> 조직 내부에서 사용하고 공공 인터넷에서는 작동 X

- 많은 클라이언트 PC는 Identd 신원확인 프로토콜 데몬 소프트웨어 실행안함
- ident 프로토콜은 HTTP 트랜잭션을 유의미하게 지연시킴
- 방화벽이 ident 트래픽에 들어오는 것을 막는 경우가 많음
- ident 프로토콜은 안전하지 않고 조작하기 쉬움
- ident 프로토콜은 가상 IP 주소를 잘 지원하지 않음
- 클라이언트 사용자 이름의 노출로 인한 프라이버시 침해의 우려가 있음
```

2. 



